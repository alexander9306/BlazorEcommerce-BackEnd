<!DOCTYPE html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
</head>

<button onclick="window.location.href='/carrito'">Volver</button>
<br />
<br />

<body>
    <script src="https://www.paypal.com/sdk/js?client-id=AUUv6SDxJwkxmv3tuj-KewurE5PizGomBdf77mzqmscHWoGWwwnQoPcGhRKTVRuNrj-G2ftrEDnem1DT">
    </script>

    <div id="paypal-button-container"></div>
</body>

<label>Total: </label>


<script>
    paypal.Buttons({
        createOrder: function (data, actions) {
            return actions.order.create({
                purchase_units: [{
                    amount: {
                        value: document.getElementById('pasteArea').value
                    }
                }]
            });
        },
        onApprove: function (data, actions) {
            return actions.order.capture().then(function (details) {
                alert('Se completo la transacción por: ' + details.payer.name.given_name);
                window.location.href = "/carrito"
            });
        }
    }).render('#paypal-button-container');
</script>

<!--El span que nos muestra el precio-->
<span id="receive"></span>
<br />

<script>
    function processForm() {
        var parameters = location.search.substring(1).split("&");
        var temp = parameters[0].split("=");
        x = unescape(temp[1]);
        document.getElementById('receive').innerHTML = x;
    }
    processForm();
</script>



<!--Para copiar el precio del span-->
<script>
    function CopyToClipboard(containerid) {
        if (document.selection) {
            var range = document.body.createTextRange();
            range.moveToElementText(document.getElementById(containerid));
            range.select().createTextRange();
            document.execCommand("copy");
        } else if (window.getSelection) {
            var range = document.createRange();
            range.selectNode(document.getElementById(containerid));
            window.getSelection().addRange(range);
            document.execCommand("copy");
            alert("Se procesó su total, ya puede guardar para pagar.")
        }
    }
</script>

<button id="button1" onclick="CopyToClipboard('receive')">Procesar Total</button>
<br />
<br />

<!--Boton e input para pegar-->
<div class="container">

    <div>
        <label>Guardar:</label>
        <br />
        <input id="pasteArea" readonly="readonly"></input>
        <br />
        <br />
        <button id="paste" onclick="guardarCompra()">Guardar para pagar</button>
        <br />
        <br />
        <h1>Pasos para realizar sú pago: </h1>
        <label>1- Procesar total.</label>
        <br />
        <label>2- Guardar para pagar.</label>
        <br />
        <label>3- Click en botón PayPal.</label>
    </div>

</div>

<script src="script.js"></script>


<!--Para pegar el precio en el input correspondiente-->
<script>
    document.getElementById('paste').addEventListener('click', () => {
        let pasteArea = document.getElementById('pasteArea');
        pasteArea.value = '';

        navigator.clipboard.readText()
            .then((text) => {
                pasteArea.value = text;
            });
    });
</script>

<script>
    function guardarCompra() {
        alert("Se guardó su total, ya puede pagar con PayPal.");
    }
</script>